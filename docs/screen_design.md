# 画面設計書

Webセキュリティ学習アプリケーションの画面構成と各画面に含まれる内容を記載します。

---

## 1. ホーム画面 (`/`)

### 1.1 画面概要
アプリケーションのエントリーポイント。学習可能なセキュリティトピック一覧を表示し、各トピックへの遷移を提供する。

### 1.2 画面構成要素

#### ヘッダー
- アプリケーションのロゴ/タイトル: "Webセキュリティ学習ラボ"
- サブタイトル: "実践的にセキュリティを学ぶ"

#### メインコンテンツ
- **ウェルカムセクション**
  - アプリケーションの概要説明
  - 学習のメリット

- **トピック一覧**
  - カード形式で複数のセキュリティトピックを表示
  - 各カードに以下の情報を表示:
    - トピック名
    - 簡単な説明（2-3行）
    - 難易度表示（初級/中級/上級）
    - トピックへのリンク

#### フッター
- 免責事項（教育目的のみ）
- GitHubリポジトリリンク（任意）
- 著作権情報

### 1.3 表示するトピック
1. **XSS（クロスサイトスクリプティング）**
   - 説明: Webセキュリティの基本的な脆弱性。攻撃の仕組みと対策を学びます。
   - 難易度: 初級
   - リンク先: `/xss`

### 1.4 ユーザーアクション
- トピックカードをクリック → 詳細学習画面へ遷移

### 1.5 レスポンシブ対応
- デスクトップ: 2-3列のグリッドレイアウト
- タブレット: 2列のグリッドレイアウト
- モバイル: 1列のレイアウト

---

## 2. XSS学習ページ (`/xss`)

### 2.1 画面概要
XSSに関する理論学習と実践演習を提供する包括的な学習ページ。

### 2.2 画面構成要素

#### ヘッダー
- ナビゲーションバー
  - ホームへ戻るボタン
  - 現在のページタイトル: "XSS学習"

#### メインコンテンツ

**2.2.1 XSSとは（理論セクション1）**
- セクションタイトル
- **定義と概要**
  - XSSとは何かの簡潔な説明
  - 重要性の説明
- **攻撃の仕組み**
  - 基本的なメカニズムの図解（テキスト説明）
  - 例：「ユーザー入力 → DB保存 → 画面表示」フロー
- **実際の被害例**
  - 実在する被害事例（抽象的に説明）
  - セッションハイジャック
  - 個人情報窃取
  - マルウェア配布

**2.2.2 XSSの種類（理論セクション2）**
各種類について以下の情報を表示:

- **Reflected XSS（反射型）**
  - 特徴: URLのクエリパラメータが即座に画面に反映される
  - 攻撃フロー図
  - 特有のリスク

- **Stored XSS（格納型）**
  - 特徴: 攻撃コードがサーバーに保存される
  - 攻撃フロー図
  - 特有のリスク
  - 影響範囲の大きさ

- **DOM-based XSS（DOM型）**
  - 特徴: JavaScriptで動的にDOMを操作する際の脆弱性
  - 攻撃フロー図
  - サーバーログに残らない特性

- **3種類の比較表**
  - 各XSSの特徴を一覧表で比較
  - 発見難易度
  - 影響度
  - 対策の難易度

**2.2.3 対策方法（理論セクション3）**

- **エスケープ処理**
  - 概要説明
  - HTML エスケープの仕組み
  - Next.jsでの実装例（コードスニペット）

- **Content Security Policy (CSP)**
  - 定義と目的
  - Next.jsでのCSP設定方法
  - 効果の説明

- **HttpOnly Cookie**
  - 目的（JavaScriptでのアクセス防止）
  - 使用場面

- **サニタイゼーション**
  - ホワイトリスト方式の説明
  - 実装時の注意点

#### フッター
- 免責事項の強調
- 次のレッスンへのリンク（将来実装）

### 2.3 ユーザーアクション
- 「実践演習へ進む」ボタン → `/xss/reflected` へ遷移
- ホームへ戻るボタン → `/` へ遷移

### 2.4 レスポンシブ対応
- セクションは全幅で表示
- コードスニペットはスクロール可能
- 比較表はモバイルではカード形式に変更

---

## 3. Reflected XSS演習ページ (`/xss/reflected`)

### 3.1 画面概要
Reflected XSS（反射型）について、実際に攻撃を体験しながら学ぶインタラクティブな演習ページ。

### 3.2 画面構成要素

#### ヘッダー
- ナビゲーションバー
  - ホームへ戻るボタン
  - 現在のページタイトル: "Reflected XSS演習"
  - 前のページに戻るボタン

#### メインコンテンツ

**3.2.1 演習概要セクション**
- このセクションの目的説明
- 学習目標の記述
- 注意事項（実験の隔離性について）

**3.2.2 脆弱なコード例表示**
- セクションタイトル: "脆弱な実装例"
- コードブロック表示
  - 言語: TypeScript/JSX
  - 脆弱なポイントをハイライト（コメント付き）
  - 実装例：
    ```
    // 危険: ユーザー入力を直接HTMLに埋め込む
    const userInput = searchParams.q;
    return <div>{userInput}</div>;  // ⚠️ XSSに脆弱
    ```

**3.2.3 脆弱なデモフォーム**
- タイトル: "攻撃をシミュレート"
- 入力フォーム
  - テキスト入力欄
  - ラベル: "検索キーワードを入力してください"
  - プレースホルダー: "例: 'XSS' または '<img src=x onerror=alert()>'"
- 「検索」ボタン
- **実行結果表示エリア**
  - 入力値がそのまま表示される（XSSが実行される可能性）
  - 表示形式: "検索結果: [ユーザー入力]"

**3.2.4 XSSペイロード例セクション**
- セクションタイトル: "試せるペイロード例"
- 複数のペイロード例をリスト表示
  - 各ペイロードは「コピー」ボタン付き
  - 例:
    1. `<img src=x onerror="alert('XSS成功！')">`
    2. `<svg onload="alert('SVG XSS')">`
    3. `<body onload="alert('攻撃成功')">`
  - 各ペイロードの説明

**3.2.5 攻撃デモンストレーションセクション**
- 「攻撃を試す」ボタン
- ペイロードを実行してアラート表示
- 成功画面:
  - "✅ 攻撃が成功しました"
  - アラートメッセージの表示
  - 実際に実行されたコード

**3.2.6 解説セクション**
- セクションタイトル: "何が起きたのか？"
- 攻撃が成功した理由の説明
- ステップバイステップの攻撃フロー図

**3.2.7 安全な実装例セクション**
- セクションタイトル: "安全な実装方法"
- 修正後のコードブロック表示
  - 脆弱なコードとの比較（Before/After）
  - 修正点のハイライト
  - 実装例：
    ```
    // 安全: Reactが自動的にテキストをエスケープ
    const userInput = searchParams.q;
    return <div>{userInput}</div>;  // ✅ 安全
    ```
  - Next.jsでの適切なエスケープ方法
  - `dangerouslySetInnerHTML`の危険性説明

**3.2.8 重要なポイントセクション**
- Next.jsでのセキュリティのベストプラクティス
- 複数のポイントをボックス表示:
  - Reactはデフォルトでテキストをエスケープ
  - HTMLを挿入する場合は事前にサニタイズ
  - ユーザー入力は常に疑わしいものとして扱う
  - `dangerouslySetInnerHTML`の使用は避ける

**3.2.9 CSP設定セクション**
- セクションタイトル: "追加の防御: CSPの設定"
- CSPヘッダーの説明
- Next.jsでのCSP設定方法
- 設定例とその効果

#### フッター
- 免責事項の強調
- 次のステップへのリンク（理論ページに戻る、またはホームへ）

### 3.3 ユーザーアクション
- ペイロード例をコピー → クリップボードにコピー
- 「検索」ボタンをクリック → 入力値を表示
- 「攻撃を試す」ボタン → アラート実行
- ナビゲーション → 他のページへ遷移

### 3.4 インタラクション仕様
- 入力フォームの入力値は即座に結果エリアに反映
- ペイロード例は入力フォームに自動入力可能
- すべてクライアントサイドで実行
- サーバーサイドに送信しない

### 3.5 レスポンシブ対応
- デスクトップ: 複数列レイアウト（コードと説明を並列表示）
- モバイル: 単列レイアウト（上下に積み重ね）
- コードブロック: スクロール可能
- ペイロード例: モバイルではコピーボタンを大きく表示

---

## 4. 画面遷移フロー

```
┌─────────────────────┐
│   ホーム画面 (/)    │
│ - トピック一覧表示  │
└──────────┬──────────┘
           │ XSSカードクリック
           ▼
┌─────────────────────┐
│ XSS学習ページ       │
│ (/xss)              │
│ - 理論学習セクション │
│ - 実演習へのリンク  │
└──────────┬──────────┘
           │ 実践演習へ進む
           ▼
┌─────────────────────┐
│ Reflected XSS演習   │
│ (/xss/reflected)    │
│ - 脆弱なデモ        │
│ - 攻撃シミュレーション│
│ - 安全な実装例      │
└─────────────────────┘
```

---

## 5. 画面別の技術要件

### 5.1 ホーム画面
- トピックデータは静的データから取得
- カードコンポーネントの再利用

### 5.2 XSS学習ページ
- 複数のセクションを折りたたみ可能（オプション）
- コードスニペットのシンタックスハイライト

### 5.3 Reflected XSS演習ページ
- クライアントサイドのみで動作
- 入力値をリアルタイムで処理
- セキュリティ: iframeでのサンドボックス化（オプション）

---

## 6. 共通要素

### 6.1 ヘッダー
- ロゴ/タイトル
- ナビゲーションメニュー（ホームへ戻る、現在のページ表示）

### 6.2 フッター
- 免責事項
- GitHubリンク
- 著作権情報

### 6.3 レスポンシブデザイン
- すべての画面でモバイル・タブレット・デスクトップ対応
- ブレークポイント: 640px, 1024px

---

## 付録: 将来実装予定の画面

### A1. Stored XSS演習 (`/xss/stored`)
- 格納型XSSの実演
- データの保存・表示シミュレーション

### A2. DOM-based XSS演習 (`/xss/dom-based`)
- DOM操作によるXSSの実演
- JavaScriptの危険な操作の例

### A3. その他トピック学習ページ
- CSRF学習
- SQLインジェクション学習
- クリックジャッキング学習
- 認証・認可学習
